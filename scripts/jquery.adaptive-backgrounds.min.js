!function(n){var t="data-ab-color",a="data-ab-parent",e="data-ab-css-background",r="ab-color-found",o={selector:"[data-adaptive-background]",parent:null,exclude:["rgb(0,0,0)","rgba(255,255,255)"],normalizeTextColor:!1,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"}};!function(n){"use strict";var t=function(){return document.createElement("canvas").getContext("2d")},a=function(n,a){var e=new Image,r=n.src||n;"data:"!==r.substring(0,5)&&(e.crossOrigin="Anonymous"),e.onload=function(){var n=t("2d");n.drawImage(e,0,0);var r=n.getImageData(0,0,e.width,e.height);a&&a(r.data)},e.src=r},e=function(n){return["rgb(",n,")"].join("")},r=function(n){return n.map(function(n){return e(n.name)})},o=5,c=10,u={};u.colors=function(n,t){t=t||{};var u=t.exclude||[],i=t.paletteSize||c;a(n,function(a){for(var c=n.width*n.height||a.length,s={},l="",d=[],m={dominant:{name:"",count:0},palette:Array.apply(null,new Array(i)).map(Boolean).map(function(){return{name:"0,0,0",count:0}})},f=0;c>f;){if(d[0]=a[f],d[1]=a[f+1],d[2]=a[f+2],l=d.join(","),s[l]=l in s?s[l]+1:1,-1===u.indexOf(e(l))){var g=s[l];g>m.dominant.count?(m.dominant.name=l,m.dominant.count=g):m.palette.some(function(n){return g>n.count?(n.name=l,n.count=g,!0):void 0})}f+=4*o}if(t.success){var p=r(m.palette);t.success({dominant:e(m.dominant.name),secondary:p[0],palette:p})}})},n.RGBaster=n.RGBaster||u}(window),n.adaptiveBackground={run:function(c){var u=n.extend({},o,c);n(u.selector).each(function(o,c){var i=n(this),s=function(){var n=l()?d():i[0];RGBaster.colors(n,{paletteSize:20,exclude:u.exclude,success:function(n){i.attr(t,n.dominant),i.trigger(r,{color:n.dominant,palette:n.palette})}})},l=function(){var n=i.attr(e);return"undefined"!=typeof n&&n!==!1},d=function(){var n=i.css("background-image"),t=/\(([^)]+)\)/,a=t.exec(n)[1].replace(/"/g,"");return a};i.on(r,function(n,t){var e;e=u.parent&&i.parents(u.parent).length?i.parents(u.parent):i.attr(a)&&i.parents(i.attr(a)).length?i.parents(i.attr(a)):l()?i:u.parent?i.parents(u.parent):i.parent(),e.css({backgroundColor:t.color});var r=function(n){var a=t.color.match(/\d+/g);return(299*a[0]+587*a[1]+114*a[2])/1e3},o=function(n){return r(n)>=128?u.normalizedTextColors.dark:u.normalizedTextColors.light},c=function(n){return r(n)<=128?u.lumaClasses.dark:u.lumaClasses.light};u.normalizeTextColor&&e.css({color:o(t.color)}),e.addClass(c(t.color)).attr("data-ab-yaq",r(t.color)),u.success&&u.success(i,t)}),s()})}}}(jQuery);